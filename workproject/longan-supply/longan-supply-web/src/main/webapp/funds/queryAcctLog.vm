<!DOCTYPE html>
<html lang="zh-CN">
#head("账户明细")

<body>
	$!errorMsg
	#header()
	
	<div class="container main-container ">
		<div class="row-fluid">
			#sidebar('acctLog')
			
			<div class="span10">
				
				
				<form id="acctLogQueryForm" action="queryAcctLog.htm" method="post" onsubmit="return submitCheck();" >
					<div class="sortable row-fluid">
						<div class="box span12">
                        #breadcrumb("账户明细",'queryAcctLog.htm?pageSize=5') 
						<table class="table recharge-table">
									<tbody>
										<tr>
                                            <td width="70"><font>订单号</font></td>
                                            <td class="center">
                                               
                                                <input class="input-small" size="10" type="text"  name="bizOrderId" value="$!acctLogQuery.bizOrderId">
                                            </td>
                                            <td width="60"> <font>交易类型</font></td>
                                            <td class="center">
                                               
                                                 #select($!billTypeList,'billType',$!acctLogQuery.billType)
                                            </td>
                                            <td width="60"><font>时间</font></td>
											<td class="input-date">
                                                <span style="position: relative">
												
													<input class="input-small doubledate" readonly="readonly" size="10" type="text" name="startGmtCreate" value="$!dateTool.format("yyyy-MM-dd", $!acctLogQuery.startGmtCreate)" /><span class="add-on"><i class="icon-calendar"></i></span>
                                                </span>
                                                <font>至</font>
                                                <span style="position: relative">
                                                    <input id="endtime" class="input-small doubledate" readonly="readonly" type="text" name="endGmtCreate" value="$!dateTool.format("yyyy-MM-dd", $!acctLogQuery.endGmtCreate)" />
                                                    <span class="add-on"><i class="icon-calendar"></i></span>
                                                </span>
	                        				</td>
											
										</tr>
										<tr>
                                            <td><font>资金流水号</font></td>
                                            <td class="center">
                                                
                                                <input class="input-small" size="10" type="text"  name="id" value="$!acctLogQuery.id">
                                            </td>
                                            <td><font>收支类型</font></td>
											<td>
	                        					
												#select($!tradeTypeList,'tradeType',$!acctLogQuery.tradeType)
											</td>
                                            
                                            <td><font>交易单号</font></td>
											<td class="center">
												
												<input class="input-small" size="10" type="text"  name="billId" value="$!acctLogQuery.billId">
											</td>
											
										</tr>
                                        <tr>
                                            <td colspan="6">
                                                <a class="btn btn-primary"  onclick="javascript:query();"  >查询</a>
                                                <input class="btn btn-primary"  type="reset" value="清空" />
                                            </td>
                                            #showTableError($!errorList,4)
                                        </tr>
									</tbody>
								</table>
						</div>
					</div>
	
					<div class="sortable row-fluid">
					<div class="box span12" style="margin-bottom: 40px;">
						<div class="box-header well" data-original-title="">
							<h2>账户明细</h2>
							<div class="box-icon">
							</div>
						</div>
						<div class="box-content">
							<table class="table">
								<thead>
									<tr>
										<th>资金流水号</th>
										<th>收入金额(元)</th>
										<th>支出金额(元)</th>
										<th>瞬间余额(元)</th>
										<th>收支类型</th>
										<th>交易单号</th>
										<th>交易类型</th>
										<th>交易时间</th>
										<th>订单号</th>
										<th>状态</th>
									</tr>
								</thead>
								<tbody>
								#foreach($!acctLog in $!acctLogList)
									<tr>
										<td>$!acctLog.id</td>
										<td class="center">$!acctLog.amtInDesc</td>
										<td class="center">$!acctLog.amtOutDesc</td>
										<td class="center">$!acctLog.amtBalanceDesc</td>
										<td class="center">$!acctLog.tradeTypeDesc</td>
										<td class="center">$!acctLog.billId</td>
										<td class="center">$!acctLog.billTypeDesc</td>
										<td class="center">$!dateTool.format("yyyy-MM-dd HH:mm:ss", $!acctLog.gmtCreate)</td>
										<td class="center">$!acctLog.bizOrderId</td>
										<td class="center">#statusStyle($!acctLog.statusDesc)</td>
										</td>
									</tr>
								#end
								
								</tbody>
							</table>
							
							</form>
						</div>
					</div>
                    #pagination2($!acctLogQuery,'acctLogQueryForm','queryAcctLog.htm')
				</div>
			</div>
		</div>
	</div>
	#footer()
	
	<script type="text/javascript">
	function submitCheck()
    {
    	if(!checkDate()){
			return false;
		}
    	return true;
    }
	
	
    var checkDate = function()
    {
    	var start_date =  jQuery("input[name='startGmtCreate']").val();
    	var end_date = jQuery("input[name='endGmtCreate']").val();
    	var objDate=new Date();
    	var year = objDate.getFullYear();
    	var month = objDate.getMonth() + 1;
    	var day = objDate.getDate();
    	month = month>=10?month:'0'+month;
    	day = day>=10?day:'0'+day;
    	var date = year + "-" + month + "-" + day;
    	
    	if(!compareDate(start_date, date)){
    		alert("起始日期不能大于当前日期！");
    		return false;
    	}
    	if(!compareDate(end_date, date)){
    		alert("终止日期不能大于当前日期！");
    		return false;
    	}
    	
    	if(!compareDate(start_date, end_date))
    	{
    		alert("起始日期不能大于终止日期!");
    		return false;
    	}
    	var  beginTime   =   new   Date(Date.parse(start_date.replace(/-/g,   "/")));
    	var  endTime   =   new   Date(Date.parse(end_date.replace(/-/g,   "/"))); 
    	var onemonthe=2*30*24*60*60*1000;
    	
    	if((endTime-beginTime)>onemonthe)
    	{
    		alert("只能查二个月之内的记录!");
    		return false;
    	}	
    	return true; 
	 	}

    function compareDate(date1, date2){
    	year1 = date1.substring(0,date1.indexOf("-"));
        year2 = date2.substring(0,date2.indexOf("-"));
        month1 = date1.substring(date1.indexOf("-") + 1,date1.lastIndexOf("-"));
        month2 = date2.substring(date2.indexOf("-") + 1,date2.lastIndexOf("-"));
        day1 = date1.substring(date1.lastIndexOf("-") + 1);
        day2 = date2.substring(date2.lastIndexOf("-") + 1);
        
        if(year1 > year2){
            return false;
        } else if(year1 < year2){
        	return true;
        } else if(month1 > month2){
            return false;
        } else if(month1 < month2){
        	return true;
        } else if(day1 > day2){
            return false;
        } else if(day1 < day2){
        	return true;
        }
        return true;
    }
		function query(){
			if(!/^[0-9]*$/.test(jQuery('#paginationCPage').val())){
	    		jQuery('#paginationCPage').attr("value",'1');
	        }
			jQuery('#acctLogQueryForm').attr("action", "$!{contextPath}funds/queryAcctLog.htm");
			jQuery('#acctLogQueryForm').submit();
		}
    </script>
</body>
</html>
