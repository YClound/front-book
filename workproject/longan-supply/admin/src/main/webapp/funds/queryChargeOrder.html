<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    #parse("common/common.vm")
    #parse("common/select.vm")
    #parse("common/pagination.vm")  
    <link rel="stylesheet" type="text/css" href="$!staticServer/css/base.css" />
    <link rel="stylesheet" type="text/css" href="$!staticServer/css/list-common.css" />
    <link rel="stylesheet" type="text/css" href="$!staticServer/css/doubleDate.css" />
    <script type="text/javascript" src="$!staticServer/js/jquery-1.7.2.js"></script>
    <script type="text/javascript" src="$!staticServer/js/jquery-ui-1.8.22.custom.min.js"></script>
    <link rel="stylesheet" type="text/css" href="$!staticServer/css/ui-lightness/jquery-ui-1.8.22.custom.css" />
    <script type="text/javascript" src="$!staticServer/js/tip.js"></script>
    <script type="text/javascript" src="$!staticServer/js/doubleDate2.0.js"></script>
    
</head>
<body class="list-body">
    $!errorMsg
    <div class="list-container">
    <div class="alert-title fz-16">充值单查询</div>
     <form id="chargeOrderQueryForm" class="queryForm" action="queryChargeOrder.do" method="post">
            
        <table class="table query-style table-striped table-bordered table-condensed">
            <thead>
                <tr>
                    <td colspan="8" class="auto-style2">请填写查询条件 </td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="w-8em">充值单号</td>
                    <td class="detail">
                        <input type="text" id="formid"  name="id" value="$!chargeOrderQuery.id"  />
                    </td>
                    <td class="w-8em">代理商名</td>
                    <td class="detail">
                        #select($!downStreamUser,'userId',$!chargeOrderQuery.userId)
                    </td>
                    <td class="w-8em">充值单状态 </td>
                    <td class="detail">
                        #select($!statusList,'status',$!chargeOrderQuery.status)
                    </td>
                </tr>
                <tr>
                    <td class="w-8em">创建日期 </td>
                    <td class="detail" colspan="3">
                        <div class="input-append">
                            <span class="input-date">
                                <input class="input-small doubledate" readonly="readonly" size="10" type="text" name="startGmtCreate" value="$!dateTool.format("yyyy-MM-dd", $!chargeOrderQuery.startGmtCreate)" />
                                <span class="add-on"><img src="../img/date.png"></span>
                            </span>至
                            <span class="input-date">
                                <input id="endtime" class="input-small doubledate" readonly="readonly" type="text" name="endGmtCreate" value="$!dateTool.format("yyyy-MM-dd", $!chargeOrderQuery.endGmtCreate)" />
                                <span class="add-on"><img src="../img/date.png"></span>
                            </span>
                        </div>
                    </td>
                </tr>
    
                <tr>
                    <td colspan="8" align="left">
                        <input class="btn btn-inverse" id="find" type="submit" value="查询" />
                        <input class="btn btn-inverse" type="reset" value="清空" />
                        <a href="chargeOrderCreate.do?type=createPre" class="btn btn-inverse add"  type="buttom" />申请入账</a>
                    </td>
                </tr>
            </tbody>
         </table>

    <table class="table table-list table-striped table-bordered table-condensed" id="list">
        <thead>
            <tr class="tr_detail">
                <td>充值单号 </td>
                <td>代理商号</td>
                <td>代理商名</td>           
                <td>入账金额 (元)</td>
                <td>申请人 </td>
                <td>审核人 </td>
                <td>申请时间 </td>
                <td>账户流水号 </td>
                <td>备注</td>
                <td>状态 </td>
                <td>操作</td>
            </tr>
        </thead>
        <tbody>
            #foreach($!chargeOrder in $!chargeOrderList)
                <tr>
                <td>$!chargeOrder.id</td>
                <td><a href="../user/userInfoShow.do?id=$!chargeOrder.userId" >$!chargeOrder.userId</a></td>
                <td><a href="../user/userInfoShow.do?id=$!chargeOrder.userId" >$!chargeOrder.userName</a></td>
                <td>$!chargeOrder.amountDesc</td>
                <td>$!chargeOrder.operName</td>
                <td>$!chargeOrder.verifyOperName</td>
                <td>$!dateTool.format("yyyy-MM-dd HH:mm:ss", $!chargeOrder.gmtCreate)</td>
                <td>$!chargeOrder.acctLogId</td>
                <td><span  title="$!chargeOrder.memo" style="overflow: hidden;display: block; text-overflow: ellipsis;width: 10em; white-space: nowrap;">$!chargeOrder.memo</span></td>
                <td>
                    <font #if($!chargeOrder.showRed())color=red #end #if($!chargeOrder.showGreen())color=green #end >
                    $!chargeOrder.statusDesc
                    </font>
                </td>
                <td>
                    #if($!chargeOrder.canDeal())
                        <a href="chargeOrderDeal.do?type=pass&chargeOrderId=$!chargeOrder.id" class="btn btn-mini btn-danger" onclick="return confirm('是否确认审核通过')">审核通过</a>
                        <a href="chargeOrderDeal.do?type=cancel&chargeOrderId=$!chargeOrder.id" class="btn btn-mini btn-danger" onclick="return confirm('是否确认审核失败操作')">审核失败</a>
                    #end
                </td>
            </tr>
            #end
           
        </tbody>
    </table>

    #pagination($!chargeOrderQuery,'chargeOrderQueryForm')
    
    </form>

    </div>
     
    <script type="text/javascript">
        $(function(){
        $('.doubledate').kuiDate({
            className:'doubledate',
            isDisabled: "1"
        });
        });
        
        
        function submitCheck()
        {
            if(!checkDate()){
                return false;
            }
            return true;
        }
        
        
        var checkDate = function()
        {
            var start_date =  jQuery("input[name='startGmtCreate']").val();
            var end_date = jQuery("input[name='endGmtCreate']").val();
            var objDate=new Date();
            var year = objDate.getFullYear();
            var month = objDate.getMonth() + 1;
            var day = objDate.getDate();
            month = month>=10?month:'0'+month;
            day = day>=10?day:'0'+day;
            var date = year + "-" + month + "-" + day;
            
            if(!compareDate(start_date, date)){
                alert("起始日期不能大于当前日期！");
                return false;
            }
            if(!compareDate(end_date, date)){
                alert("终止日期不能大于当前日期！");
                return false;
            }
            
            if(!compareDate(start_date, end_date))
            {
                alert("起始日期不能大于终止日期!");
                return false;
            }
            var  beginTime   =   new   Date(Date.parse(start_date.replace(/-/g,   "/")));
            var  endTime   =   new   Date(Date.parse(end_date.replace(/-/g,   "/"))); 
            var onemonthe=2*30*24*60*60*1000;
            
            if((endTime-beginTime)>onemonthe)
            {
                alert("只能查二个月之内的记录!");
                return false;
            }   
            return true; 
        }
    
        function compareDate(date1, date2){
            year1 = date1.substring(0,date1.indexOf("-"));
            year2 = date2.substring(0,date2.indexOf("-"));
            month1 = date1.substring(date1.indexOf("-") + 1,date1.lastIndexOf("-"));
            month2 = date2.substring(date2.indexOf("-") + 1,date2.lastIndexOf("-"));
            day1 = date1.substring(date1.lastIndexOf("-") + 1);
            day2 = date2.substring(date2.lastIndexOf("-") + 1);
            
            if(year1 > year2){
                return false;
            } else if(year1 < year2){
                return true;
            } else if(month1 > month2){
                return false;
            } else if(month1 < month2){
                return true;
            } else if(day1 > day2){
                return false;
            } else if(day1 < day2){
                return true;
            }
            return true;
        }
        
    </script>
</body>
</html>
